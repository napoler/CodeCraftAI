# 贡献指南

感谢您有兴趣为本项目做出贡献！本文档概述了开发流程、编码标准和最佳实践，以确保我们的代码库保持干净、一致和可维护。

## Python 风格指南：PEP 8

本项目中的所有 Python 代码都必须严格遵守 [PEP 8 风格指南](https://www.python.org/dev/peps/pep-0008/)。

遵守该指南不是可选的，它将通过 pre-commit 钩子由 `black` 和 `ruff` 自动强制执行。

## 核心理念：文档驱动开发

本项目遵循一个简单的规则：**如果它不在文档中，它就不存在。** 每一项变更都必须先有一个经过评审和批准的 `spec` 或 `ADR`。

请遵循 `AIAgents.md` 中详述的工作流程，该流程使用 `cli.py` 工具来管理整个开发生命周期。

## 代码风格与质量

我们执行一套严格的代码风格和质量标准以保持一致性。

- **格式化：** 所有 Python 代码都使用 `black` 自动格式化。
- **代码检查 (Linting)：** 我们使用 `ruff` 来捕捉常见错误和风格问题。
- **类型提示：** 所有新代码都必须完全添加类型提示，并通过 `mypy` 检查。

这些检查由 `pre-commit` 钩子自动运行，所有贡献者都必须使用。

## 代码级文档标准

代码中清晰而全面的文档与代码本身同等重要。

### 1. 文档字符串 (Docstrings)

-   所有公共的模块、类、函数和方法都必须有文档字符串。
-   我们遵循 [Google Python 风格指南](https://google.github.io/styleguide/pyguide.html#3.8-comments-and-docstrings) 进行文档字符串的格式化。
-   文档字符串应清晰地解释组件的功能、其参数 (`Args:`) 以及返回值 (`Returns:`)。

**示例:**
```python
def my_function(param1: int, param2: str) -> bool:
    """这是一个关于函数的简短描述。

    本节提供关于函数行为、边界情况和实现说明的更多细节。

    Args:
        param1: 第一个参数，代表 [描述]。
        param2: 第二个参数，代表 [描述]。

    Returns:
        如果操作成功则返回 True，否则返回 False。
    """
    # ... 函数体 ...
```

### 2. 行内注释

-   使用行内注释来解释 **“为什么”**，而不是 **“做什么”**。代码本身应该能清楚地说明它在做什么。注释应该用于阐明复杂的逻辑、业务规则或特定实现选择背后的原因。

**好的注释 (解释“为什么”):**
```python
# 我们使用 1e-9 的容差来避免浮点数精度问题。
if abs(a - b) < 1e-9:
    ...
```
**坏的注释 (解释“做什么”):**
```python
# 检查 a 是否接近 b。
if abs(a - b) < 1e-9:
    ...
```

### 3. 引用与参考

-   如果您的实现是基于或改编自外部来源（例如，一篇研究论文、一篇博客文章、一个 Stack Overflow 的回答，或另一个开源项目），您 **必须** 在注释中提供引用来源。
-   这样做既能给予他人应有的荣誉，也为未来的开发者提供了上下文，有助于理解解决方案的起源。

**示例:**
```python
def highly_optimized_algorithm():
    # 本实现改编自下述文章中描述的算法：
    # https://example.com/some-clever-algorithm
    # 它已被修改以处理我们特定的数据结构。
    ...
```

通过遵守这些标准，我们确保我们的项目不仅功能完善，而且易于理解，便于他人贡献。

## 文件头标准

所有新的 Python (`.py`) 文件都必须以下列头块开始。这确保了每个文件都是可追溯的，并且其目的能够一目了然。

```python
# -*- coding: utf-8 -*-
"""
@File    :   [文件名]
@Time    :   [YYYY-MM-DD HH:MM:SS]
@Author  :   [作者名或 AI 代理 ID]
@Version :   1.0
@Desc    :   [关于文件用途的简短描述]
"""
```

- **@Author:** 如果您是 AI，请使用您的 Git 用户名或 `AI Agent`。
- **自动化:** 我们正在积极探索一个 pre-commit 钩子，以自动插入并更新此文件头的时间戳。
