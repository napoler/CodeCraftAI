<规约 UID="spec-003">

  <details>
    <summary>元数据 (点击展开)</summary>
    <元数据>
      <标题>规约：规约 Linter (静态检查器)</标题>
      <摘要>开发一个静态分析工具，用于检查 `.md` 规约文件是否符合 `CodeCraft Spec` 的语法和规则，从而在早期阶段预防错误和不一致性。</摘要>
      <分类>自动化工具</分类>
      <状态>已批准</状态>
      <负责人>@jules-ai</负责人>
      <流程级别>Tier-1</流程级别>
    </元数据>
  </details>

  <details>
    <summary>上下文 (点击展开)</summary>
    <上下文>
      <项目 名称="CodeCraftAI">
        <技术栈>Python</技术栈>
        <架构>CodeCraft Spec 驱动</架构>
      </项目>
      <关联>
        <原则>../../PRINCIPLES.md</原则>
        <语法>../../SYNTAX.md</语法>
        <工具>../feat/indexer-tool/spec.md</工具>
      </关联>
    </上下文>
  </details>

  <指令分析>
    <details>
      <summary>核心请求 (点击展开)</summary>
      <核心请求>
        <目标>创建一个“代码规约的编译器”，在规约被批准和实施前，主动捕捉所有格式、语法和逻辑上的错误。这是减少下游 bug 的关键机制。</目标>
      </核心请求>
    </details>
  </指令分析>

  <实施计划>
    <details>
      <summary>阶段化开发 (点击展开)</summary>
      <阶段化开发>
        <核心功能>
          <功能 UID="spec-003-func-001">
            <名称>UID 唯一性检查</名称>
            <描述>遍历所有 `.md` 规约文件，提取所有 `<规约>` 和 `<功能>` 标签的 UID 属性，并检查是否存在任何重复。这是保障知识图谱一致性的最关键检查。</描述>
            <测试策略>单元测试需要覆盖：1. 发现并报告一个重复的规约 UID。 2. 发现并报告一个重复的功能 UID。 3. 在所有 UID 都唯一时，成功通过。</测试策略>
          </功能>
          <功能 UID="spec-003-func-002">
            <名称>XML 语法有效性检查</名称>
            <描述>对指定的 `.md` 文件内容进行解析，验证所有自定义 XML 风格的标签（如 `<元数据>`, `<核心功能>` 等）都已正确配对和闭合，且没有交叉嵌套。</描述>
            <测试策略>单元测试应能捕捉：1. 标签未闭合的错误。 2. 标签交叉嵌套的错误。 3. 根元素不是 `<规约>` 的错误。</测试策略>
          </功能>
          <功能 UID="spec-003-func-003">
            <名称>强制性结构检查</名称>
            <描述>验证规约文件是否包含所有必需的结构化标签，例如，`<实施计划>` 标签下必须包含 `<阶段化开发>` 标签，而后者又必须包含 `<核心功能>`。</描述>
            <测试策略>单元测试应能发现：1. 缺少 `<阶段化开发>` 标签的规约。 2. `<核心功能>` 标签下没有任何 `<功能>` 的规约。</测试策略>
          </功能>
        </核心功能>
        <次要功能>
          <功能 UID="spec-003-func-004">
            <名称>内部链接有效性检查</名称>
            <描述>解析所有 `<引用 目标="...">` 标签，并验证其 `目标` 属性指向的 UID 是否在知识库中真实存在。</描述>
            <测试策略>单元测试应能发现一个指向不存在的 UID 的坏链接。</测试策略>
          </功能>
        </次要功能>
      </阶段化开发>
    </details>
  </实施计划>

</规约>
