# CodeCraft Spec 工作流 v2

本规约定义了 `CodeCraftAI` 项目的**分级工作流**。所有变更都必须根据其性质，选择合适的流程级别。

## 流程分级 (Tiered Process)

为了平衡**严谨性**与**敏捷性**，我们定义了两种流程级别：

-   **Tier-1 (Full):** **默认流程**，适用于所有**新功能**、**重大架构变更**或**任何对现有接口产生破坏性修改**的变更。此流程强制执行所有的文档、审批和审查环节。
-   **Tier-2 (Lite):** **简化流程**，适用于**小型的 bug 修复**、**非功能性的代码重构**或**不影响任何现有接口**的内部实现优化。

**在创建任何变更时，必须在 `spec.md` 的 `<元数据>` 中明确声明其流程级别，例如 `<流程级别>Tier-1</流程级别>`。**

---

## Tier-1 (Full) 工作流

这是最严谨的流程，包含所有的人机交互和文档节点。

1.  **Phase 1: 提案** (分析索引 -> 创建 `spec.md` 草案)
2.  **Phase 2: 审查与完善** (人机协作，批准 `spec.md`)
3.  **Phase 2.5: 细化与审批** (AI 创建 `DEV_SPEC.md` 草案 -> **暂停** -> 人类审批)
4.  **Phase 3: 实施** (根据已审批的文档进行 TDD 开发)
5.  **Phase 4: 验证与文档同步** (测试 -> 全面更新所有受影响的文档)
6.  **Phase 5: 归档与索引** (归档 -> 更新 `INDEX.md`)

---

## Tier-2 (Lite) 工作流

这是为提升敏捷性而设计的简化流程。

1.  **Phase 1: 提案** (分析索引 -> 创建 `spec.md` 草案)
    - 在此级别，`spec.md` 可以更简洁，重点在于清晰地描述问题和解决方案。

2.  **Phase 2: 审查与实施**
    - AI 在完成 `spec.md` 后，可**直接生成 `tasks.md`**（无需创建 `DEV_SPEC.md`）。
    - **无需等待人类审批**，AI 在向用户报告其计划后，可立即开始实施。**人类用户保留随时叫停的权力。**

3.  **Phase 3: 验证与归档**
    - 运行所有测试。
    - **文档同步仍是强制的**，但范围通常更小。
    - 归档并（如果需要）更新索引。

通过这套分级系统，我们确保了在需要严谨的地方绝不妥协，在可以加速的地方绝不拖延。
