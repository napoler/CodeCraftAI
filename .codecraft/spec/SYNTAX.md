# CodeCraft Spec: 知识索引与规约语法 (SYNTAX.md)

本规范定义了 `CodeCraft Spec` 的核心语法。其最终目标是创建一个**自维护的、代码与文档一体化的项目知识库索引系统**。

## 1. 核心理念：万物皆可索引

我们系统的基石是**唯一标识符 (UID)**。项目中的每一个核心概念——无论是整个规约，还是规约中定义的单个功能——都必须被赋予一个全局唯一的 UID。

通过这套 UID 系统，我们可以将所有规约链接成一个可供机器查询的**知识图谱**。

## 2. UID (唯一标识符)

- **格式:** UID 采用 `type-NNN` 或 `parent_uid-type-NNN` 的格式。
  - `spec-001`
  - `spec-001-func-001`
  - `spec-001-api-001`
- **全局唯一:** 任何两个实体都不能拥有相同的 UID。

## 3. 核心语法

### 3.1 规约级标签
- **`<规约 UID="spec-XXX">`:** 任何 `spec.md` 文件的根元素，必须包含一个唯一的 UID 属性。
- **`<元数据>`:** 包含规约的元信息。
  - **`<标题>`:** 人类可读的标题。
  - **`<摘要>`:** 规约的目标摘要。

### 3.2 功能级标签
- **`<功能 UID="spec-XXX-func-YYY">`:** 用于定义一个独立的功能单元。
  - **`<名称>`:** 人类可读的功能名称。
  - **`<描述>`:** 对功能的详细描述。
  - **`<接口>`:** 定义功能的 API 或函数签名。
  - **`<约束>`:** 定义此功能必须遵守的约束。

### 3.3 引用标签
- **`<引用 目标="UID-XXX" />`:** 用于在文档中的任何位置，创建一个指向另一个索引实体的链接。这是构建知识图谱的关键。

## 4. 示例
```markdown
<规约 UID="spec-001">
  <元数据>
    <标题>用户认证服务</标题>
  </元数据>

  <实施计划>
    <功能 UID="spec-001-func-001">
      <名称>用户登录</名称>
      <描述>处理用户的用户名和密码验证。</描述>
      <接口>POST /login (username, password)</接口>
    </功能>

    <功能 UID="spec-001-func-002">
      <名称>JWT 令牌生成</名称>
      <描述>
        在用户成功登录后，生成一个 JWT 令牌。
        此功能依赖于 <引用 目标="spec-002-crypto-001" /> 中定义的加密标准。
      </描述>
    </功能>
  </实施计划>
</规约>
```

通过这套语法，我们交付的不仅仅是文档，而是一个活的、可查询的、与代码实现强绑定的项目知识库。
